---
layout: post
title:  "ì„±ì ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ìš”ì¸ ë¶„ì„"
summary: "Analytics"
author: KSJ
date: '2021-03-12 09:41:00 +0900'
categories: Analytics
---

## **ë¶„ì„ì£¼ì œ :í•™ìŠµ ì„±ê³µ/ì‹¤íŒ¨ ìš”ì†Œ**

----------

ì—°êµ¬ë°ì´í„°ì¸ í•™ìŠµê´€ë ¨ ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ DATA HANDLING, EDA, MODELINGì„ ì§„í–‰í•´ ë³´ë ¤ê³  í•©ë‹ˆë‹¤.
í•´ë‹¹ ë°ì´í„°ëŠ” ìºê¸€ì˜ ë‹¤ìŒ URLì—ì„œ ì‚´í´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
https://www.kaggle.com/aljarah/xAPI-Edu-Data

ë°ì´í„°ì˜ ê²½ìš°, xAPI-Edu-Data ë°ì´í„°ì…‹ì¸ xAPI-Edu-Data.csvë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

## Contents

1. [ë°ì´í„° ë¶„ì„ ë¬¸ì œ ì •ì˜](#1.-ë°ì´í„°-ë¶„ì„-ë¬¸ì œ-ì •ì˜)
2. [ë°ì´í„° EDA](3.-ë°ì´í„°EDA)
3. [ë°ì´í„° í•¸ë“¤ë§](#2.ë°ì´í„°-í•¸ë“¤ë§)
4. [ëª¨ë¸ë§](#4.-ëª¨ë¸ë§)
5. [ë§ˆë¬´ë¦¬](#5.-ë§ˆë¬´ë¦¬)

ë³€ìˆ˜ì˜ ì˜ë¯¸ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.<br>

    - ê° íŒŒì¼ì˜ ì»¬ëŸ¼ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.
    gender: í•™ìƒì˜ ì„±ë³„ (M: ë‚¨ì„±, F: ì—¬ì„±)
    NationaliTy: í•™ìƒì˜ êµ­ì 
    PlaceofBirth: í•™ìƒì´ íƒœì–´ë‚œ êµ­ê°€
    StageID: í•™ìƒì´ ë‹¤ë‹ˆëŠ” í•™êµ (ì´ˆ,ì¤‘,ê³ )
    GradeID: í•™ìƒì´ ì†í•œ ì„±ì  ë“±ê¸‰
    SectionID: í•™ìƒì´ ì†í•œ ë°˜ ì´ë¦„
    Topic: ìˆ˜ê°•í•œ ê³¼ëª©
    Semester: ìˆ˜ê°•í•œ í•™ê¸° (1í•™ê¸°/2í•™ê¸°)
    Relation: ì£¼ ë³´í˜¸ìì™€ í•™ìƒì˜ ê´€ê³„
    raisedhands: í•™ìƒì´ ìˆ˜ì—… ì¤‘ ì†ì„ ë“  íšŸìˆ˜
    VisITedResources: í•™ìƒì´ ê³¼ëª© ê³µì§€ë¥¼ í™•ì¸í•œ íšŸìˆ˜
    Discussion: í•™ìƒì´ í† ë¡  ê·¸ë£¹ì— ì°¸ì—¬í•œ íšŸìˆ˜
    ParentAnsweringSurvey: ë¶€ëª¨ê°€ í•™êµ ì„¤ë¬¸ì— ì°¸ì—¬í–ˆëŠ”ì§€ ì—¬ë¶€
    ParentschoolSatisfaction: ë¶€ëª¨ê°€ í•™êµì— ë§Œì¡±í–ˆëŠ”ì§€ ì—¬ë¶€
    StudentAbscenceDays: í•™ìƒì˜ ê²°ì„ íšŸìˆ˜ (7íšŒ ì´ìƒ/ë¯¸ë§Œ)
    Class: í•™ìƒì˜ ì„±ì  ë“±ê¸‰ (L: ë‚®ìŒ, M: ë³´í†µ, H: ë†’ìŒ)


â€‹    
- ë°ì´í„° ì¶œì²˜: https://www.kaggle.com/aljarah/xAPI-Edu-Data

## í•´ë‹¹ ë¶„ì„ì—ì„œ ë°°ìš¸ ìˆ˜ ìˆëŠ” ê²ƒ
    - ì—°êµ¬ìš© ë°ì´í„°ì˜ ì´í•´
    - ë°ì´í„° ì‹œê°í™”
    - Scikit-learn ê¸°ë°˜ ëª¨ë¸ í•™ìŠµ ë°©ë²• ìŠµë“
    - Logistic Regression, XGBoost ëª¨ë¸ë§ ë°©ë²•
    - í•™ìŠµëœ ëª¨ë¸ì˜ í‰ê°€ ë°©ë²• ë° ì‹œê°í™” ë°©ë²•

---

# 1. **ë°ì´í„° ë¶„ì„ ë¬¸ì œ ì •ì˜**



í•´ë‹¹ ë¶„ì„ì˜ ê²½ìš°, class(í•™ìƒì˜ ì„±ì ë“±ê¸‰)ê°€ target ê°’ì…ë‹ˆë‹¤. ë‚®ìŒ/ë³´í†µ/ë†’ìŒìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ë°ì´í„°ì…‹ ì¤€ë¹„


```python
import pandas as pd

import numpy as np

import matplotlib.pyplot as plt

import seaborn as sns
```

###  Colab Notebookì— Kaggle API ì„¸íŒ…í•˜ê¸°



```python
import os
```


```python
# os.environì„ ì´ìš©í•˜ì—¬ Kaggle API Username, Key ì„¸íŒ…í•˜ê¸°

os.environ['KAGGLE_USERNAME']='sojeongkimdesign'

os.environ['KAGGLE_KEY']='bd7482b7426c6d140c3e8ef3b602b202'
```

### ë°ì´í„° ë‹¤ìš´ë¡œë“œ ë° ì••ì¶• í•´ì œí•˜ê¸°



```python
# Linux ëª…ë ¹ì–´ë¡œ Kaggle APIë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ì…‹ ë‹¤ìš´ë¡œë“œí•˜ê¸° (!kaggle ~)

# Linux ëª…ë ¹ì–´ë¡œ ì••ì¶• í•´ì œí•˜ê¸°



!kaggle -h

!kaggle datasets download -d aljarah/xAPI-Edu-Data

!unzip '*.zip'
```

    usage: kaggle [-h] [-v] {competitions,c,datasets,d,kernels,k,config} ...
    
    optional arguments:
      -h, --help            show this help message and exit
      -v, --version         show program's version number and exit
    
    commands:
      {competitions,c,datasets,d,kernels,k,config}
                            Use one of:
                            competitions {list, files, download, submit, submissions, leaderboard}
                            datasets {list, files, download, create, version, init, metadata, status}
                            config {view, set, unset}
        competitions        Commands related to Kaggle competitions
        datasets            Commands related to Kaggle datasets
        kernels             Commands related to Kaggle kernels
        config              Configuration settings
    Downloading xAPI-Edu-Data.zip to /content
      0% 0.00/5.54k [00:00<?, ?B/s]
    100% 5.54k/5.54k [00:00<00:00, 7.91MB/s]
    Archive:  xAPI-Edu-Data.zip
      inflating: xAPI-Edu-Data.csv       


### Pandas ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ csvíŒŒì¼ ì½ì–´ë“¤ì´ê¸°



```python
ls
```

    [0m[01;34msample_data[0m/  xAPI-Edu-Data.csv  xAPI-Edu-Data.zip



```python
# pd.read_csv()ë¡œ csvíŒŒì¼ ì½ì–´ë“¤ì´ê¸°

df = pd.read_csv('xAPI-Edu-Data.csv')
```

# **2. ë°ì´í„° EDA**


##2-1. ë°ì´í„°í”„ë ˆì„ì˜ ê° ì»¬ëŸ¼ ë¶„ì„



```python
# DataFrameì—ì„œ ì œê³µí•˜ëŠ” ë©”ì†Œë“œë¥¼ ì´ìš©í•˜ì—¬ ì»¬ëŸ¼ ë¶„ì„í•˜ê¸° (head(), info(), describe())



df.head()

print(df.head().to_markdown())
```

    |    | gender   | NationalITy   | PlaceofBirth   | StageID    | GradeID   | SectionID   | Topic   | Semester   | Relation   |   raisedhands |   VisITedResources |   AnnouncementsView |   Discussion | ParentAnsweringSurvey   | ParentschoolSatisfaction   | StudentAbsenceDays   | Class   |
    |---:|:---------|:--------------|:---------------|:-----------|:----------|:------------|:--------|:-----------|:-----------|--------------:|-------------------:|--------------------:|-------------:|:------------------------|:---------------------------|:---------------------|:--------|
    |  0 | M        | KW            | KuwaIT         | lowerlevel | G-04      | A           | IT      | F          | Father     |            15 |                 16 |                   2 |           20 | Yes                     | Good                       | Under-7              | M       |
    |  1 | M        | KW            | KuwaIT         | lowerlevel | G-04      | A           | IT      | F          | Father     |            20 |                 20 |                   3 |           25 | Yes                     | Good                       | Under-7              | M       |
    |  2 | M        | KW            | KuwaIT         | lowerlevel | G-04      | A           | IT      | F          | Father     |            10 |                  7 |                   0 |           30 | No                      | Bad                        | Above-7              | L       |
    |  3 | M        | KW            | KuwaIT         | lowerlevel | G-04      | A           | IT      | F          | Father     |            30 |                 25 |                   5 |           35 | No                      | Bad                        | Above-7              | L       |
    |  4 | M        | KW            | KuwaIT         | lowerlevel | G-04      | A           | IT      | F          | Father     |            40 |                 50 |                  12 |           50 | No                      | Bad                        | Above-7              | M       |



```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 480 entries, 0 to 479
    Data columns (total 17 columns):
     #   Column                    Non-Null Count  Dtype 
    ---  ------                    --------------  ----- 
     0   gender                    480 non-null    object
     1   NationalITy               480 non-null    object
     2   PlaceofBirth              480 non-null    object
     3   StageID                   480 non-null    object
     4   GradeID                   480 non-null    object
     5   SectionID                 480 non-null    object
     6   Topic                     480 non-null    object
     7   Semester                  480 non-null    object
     8   Relation                  480 non-null    object
     9   raisedhands               480 non-null    int64 
     10  VisITedResources          480 non-null    int64 
     11  AnnouncementsView         480 non-null    int64 
     12  Discussion                480 non-null    int64 
     13  ParentAnsweringSurvey     480 non-null    object
     14  ParentschoolSatisfaction  480 non-null    object
     15  StudentAbsenceDays        480 non-null    object
     16  Class                     480 non-null    object
    dtypes: int64(4), object(13)
    memory usage: 63.9+ KB


ì—°êµ¬ìš© ë°ì´í„°ì´ë¯€ë¡œ ë¹„ì›Œì ¸ìˆëŠ” ë°ì´í„°ê°€ ì—†ëŠ” ê¹”ë”í•œ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìˆ˜ì¹˜í˜• ë°ì´í„°ê°€ ì •ìˆ˜í˜•ìœ¼ë¡œ ë˜ì–´ìˆëŠ”ê±¸ ë³¼ ìˆ˜ ìˆëŠ”ë° ë²”ì£¼í˜•ì€ stringìœ¼ë¡œ ë“¤ì–´ê°€ ìˆìŠµë‹ˆë‹¤. infoì—ëŠ” objectë¡œ ëœ¨ëŠ”ë° ê°ì²´ë¼ëŠ” ì˜ë¯¸ì´ê³ 

ì •í™•í•œ classëŠ” íŒŒì•…í•˜ì§€ ëª»í•œ ê²ƒìœ¼ë¡œ ë³´ì´ë„¤ìš”.

ëª‡ê°€ì§€ ë³€ìˆ˜ì˜ classë¥¼ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.


```python
df.columns
```




    Index(['gender', 'NationalITy', 'PlaceofBirth', 'StageID', 'GradeID',
           'SectionID', 'Topic', 'Semester', 'Relation', 'raisedhands',
           'VisITedResources', 'AnnouncementsView', 'Discussion',
           'ParentAnsweringSurvey', 'ParentschoolSatisfaction',
           'StudentAbsenceDays', 'Class'],
          dtype='object')




```python
df['gender'].value_counts()
```




    M    305
    F    175
    Name: gender, dtype: int64




```python
df['NationalITy'].value_counts()
```




    KW             179
    Jordan         172
    Palestine       28
    Iraq            22
    lebanon         17
    Tunis           12
    SaudiArabia     11
    Egypt            9
    Syria            7
    USA              6
    Iran             6
    Lybia            6
    Morocco          4
    venzuela         1
    Name: NationalITy, dtype: int64




```python
df.describe()

print(df.describe().to_markdown())
```

    |       |   raisedhands |   VisITedResources |   AnnouncementsView |   Discussion |
    |:------|--------------:|-------------------:|--------------------:|-------------:|
    | count |      480      |           480      |            480      |     480      |
    | mean  |       46.775  |            54.7979 |             37.9188 |      43.2833 |
    | std   |       30.7792 |            33.08   |             26.6112 |      27.6377 |
    | min   |        0      |             0      |              0      |       1      |
    | 25%   |       15.75   |            20      |             14      |      20      |
    | 50%   |       50      |            65      |             33      |      39      |
    | 75%   |       75      |            84      |             58      |      70      |
    | max   |      100      |            99      |             98      |      99      |


ìˆ˜ì¹˜í˜• ë°ì´í„°ë“¤ì´ ì–´ë–¤ íŠ¹ì„±ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

##2-2 ìˆ˜ì¹˜í˜• ë°ì´í„° EDA



### seabornì˜ histplot, jointplot, pairplotì„ ì´ìš©í•´ íˆìŠ¤í† ê·¸ë¨ ê·¸ë¦¬ê¸°

#### histplot

- raisedhands




```python
sns.histplot(x='raisedhands',data=df,hue = 'Class', hue_order=('L','M','H'),kde =True)

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_24_0.png)


ëšœë ·í•˜ê²Œ ìŒë´‰ í˜•íƒœë¡œ ë‚˜íƒ€ë‚˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Lì˜ ê²½ìš°, raisehandsê°€ ë‚®ì€ ìª½ì— ëª°ë ¤ ìˆìŠµë‹ˆë‹¤.

Mì˜ ê²½ìš°, ìŒë´‰ì— ëª¨ë‘ ì†í•´ìˆê³ ,

Hì˜ ê²½ìš°  raisehandsì˜ ë†’ì€ ìª½ì— ëª°ë ¤ ìˆìŠµë‹ˆë‹¤.



ì¦‰ ì†ì„ ë§ì´ ë“  í•™ìƒì´ ë“±ê¸‰ì´ ë†’ì„ ê²ƒì´ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒê´€ì„±ì´ ìˆë‹¤ëŠ” ê±°ì£ .

- VisITedResources: í•™ìƒì´ ê³¼ëª© ê³µì§€ë¥¼ í™•ì¸í•œ íšŸìˆ˜


```python
sns.histplot(x='VisITedResources',data=df,hue = 'Class', hue_order=('L','M','H'),kde =True)

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_27_0.png)


ì†ë“œëŠ” í•™ìƒê³¼ ë¹„ìŠ·í•œ ì–‘ìƒì„ ë³´ì´ì§€ë§Œ,

Mì˜ ë†’ì€ ìª½ìœ¼ë¡œ ëª°ë ¤ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. <br>

ì¦‰, í•™ìƒì´ ê³¼ëª© ê³µì§€ë¥¼ í™•ì¸í•œ íšŸìˆ˜ê°€ ì†ì„ ë“œëŠ” í–‰ìœ„ë³´ë‹¤

ì¡°ê¸ˆ ë” ì„±ì ì— ì˜í–¥ì„ ë” ì£¼ëŠ” ê²ƒìœ¼ë¡œ ì¶”ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <br>



- AnnouncementsView


```python
sns.histplot(x='AnnouncementsView',data=df,hue = 'Class', hue_order=('L','M','H'),kde =True)

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_29_0.png)


Lì¸ í•™ìƒì€ ìˆ˜ì—… ì™¸ì ì¸ ì•ŒëŒì„ í™•ì¸í•˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ë§ê³ ,H,Mì˜ í•™ìƒì€ ì¼ë°˜ ê³µì§€í™•ì¸ì—ëŠ” í° ì—°ê´€ì„±ì€ ì—†ì–´ë³´ì…ë‹ˆë‹¤. ì¦‰ H,Mí•™ìƒë„ ì¼ë°˜ ê³µì§€ì—ëŠ” ê´€ì‹¬ì—†ëŠ” ê²½ìš°ë„ ê½¤ ìˆë‹¤ëŠ” ê±¸ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.



- Discussion




```python
sns.histplot(x='Discussion',data=df,hue = 'Class', hue_order=('L','M','H'),kde =True)

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_31_0.png)


Discussionì˜ ê²½ìš° ê²½í–¥ì„±ì´ ì˜ ë³´ì´ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.

L,Mì˜ ê²½ìš° ë””ìŠ¤ì»¤ì…˜ì´ ë‚®ì€ìª½ì— ëª°ë ¤ìˆê³ 

HëŠ” ìŒë´‰ í˜•íƒœë¡œ ë‚˜íƒ€ë‚˜ê³  ìˆìŠµë‹ˆë‹¤.

#### jointplot


```python
sns.jointplot(x='VisITedResources',y='raisedhands',data=df, hue ='Class', hue_order=('L','M','H'))

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_34_0.png)


Lê³¼ Mì€ êµ¬ë¶„ì´ ì˜ ë˜ëŠ” ê²ƒì´ ë³´ì´ë„¤ìš”.



#### pariplot

ëª¨ë“  ê²½ìš°ì˜ ì¡°ì¸íŠ¸ í”Œëì„ í•œë²ˆì— ì¶œë ¥í•´ì£¼ëŠ” plot


```python
sns.pairplot(df, hue ='Class', hue_order=['L','M','H'])

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_36_0.png)


pairplotì„ í–ˆì„ë•Œ scatter plotì´ ì¼ìë¡œ ë‚˜íƒ€ë‚˜ë©´ ë‚˜íƒ€ë‚ ìˆ˜ë¡ ë‘ ê°€ì§€ê°€ ìƒê´€ì„±ì´ ë†’ë‹¤ëŠ” ê²ƒì¸ë°

í¼ì³ì ¸ìˆëŠ” ê²ƒì€ ìƒê´€ì„±ì´ ë‚®ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

í´ë˜ìŠ¤ê°€ ì˜ ê°ˆë¼ì§€ëŠ” ë¶„í¬ë¡œ ë‚˜ì˜¨ë‹¤ëŠ” ê²ƒì€ 

ì„œë¡œ ë‹¤ë¥¸ ë‘ ê°€ì§€ë¥¼ ë™ì‹œì— ë³´ëŠ” ê²ƒì´ ìœ ìš©í•˜ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

## 2-3. ë²”ì£¼í˜• ë°ì´í„° EDA
#### Countplot



```python
sns.countplot(x= 'Class', data = df,order=['L','M','H'])

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_39_0.png)



```python
sns.countplot(x= 'gender', data = df,hue = 'Class', hue_order=['L','M','H'])

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_40_0.png)


ë‚¨í•™ìƒì€ ì„±ì ì´ ë‚®ì€ ìª½ì— ë¶„í¬

ë¹„ìœ¨ë¡œ ë³´ë©´ ì—¬í•™ìƒì´ ì„±ì ì´ ì¢‹ì€í¸ì´ë„¤ìš”.


```python
df.columns
```




    Index(['gender', 'NationalITy', 'PlaceofBirth', 'StageID', 'GradeID',
           'SectionID', 'Topic', 'Semester', 'Relation', 'raisedhands',
           'VisITedResources', 'AnnouncementsView', 'Discussion',
           'ParentAnsweringSurvey', 'ParentschoolSatisfaction',
           'StudentAbsenceDays', 'Class'],
          dtype='object')




```python
sns.countplot(x= 'NationalITy', data = df,hue = 'Class', hue_order=['L','M','H'])

plt.xticks(rotation=90)

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_43_0.png)


ì„±ì ì´ ì¢‹ì§€ ì•Šì€ ìª½ì— ëª°ë ¤ìˆëŠ” ë‚˜ë¼ëŠ” ì¿ ì›¨ì´íŠ¸, ì¢‹ì€ ìª½ì€ ë¯¸êµ­/ë ˆë°”ë…¼/ìš”ë¥´ë‹¨/ì´ë¼í¬ë¥¼ ë³¼ ìˆ˜ ìˆê² ë„¤ìš”.



ë°ì´í„° ê°„ì˜ ìƒê´€ì„±ì„ ë³´ëŠ”ê±°ì§€ dependencyë¥¼ ë³´ëŠ”ê²Œ ì•„ë‹ˆë‹ˆ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.


```python
sns.countplot(x= 'ParentAnsweringSurvey', data = df,hue = 'Class', hue_order=['L','M','H'])

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_45_0.png)


ë¶€ëª¨ê°€ ì„¤ë¬¸ì¡°ì‚¬ì— ì‘í•œ ê²½ìš°, Lì¸ ê²½ìš°ê°€ ë§ì§€ ì•Šë„¤ìš”. ë¶€ëª¨ì˜ ê´€ì‹¬ì´ í•™ìƒ ì„±ì ì— ìƒê´€ì„±ì´ ìˆë‹¤ëŠ” ê±°ì£ .


```python
sns.countplot(x= 'ParentschoolSatisfaction', data = df,hue = 'Class', hue_order=['L','M','H'])

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_47_0.png)


ë§Œì¡±í•œ ê²½ìš°, ì„±ì ì´ ì¢‹ê²Œ ë‚˜ì˜¤ëŠ”ë°ìš”. 

ì„±ì ì´ ì¢‹ì•˜ê¸° ë•Œë¬¸ì— ë§Œì¡±ì´ ë†’ì•˜ì„ ìˆ˜ë„ ìˆìœ¼ë‹ˆ ì„±ì ì„ ì•Œê¸° ì „ì— í•œ ì„¤ë¬¸ì¸ì§€ ì—¬ë¶€ì— ë”°ë¼ ë¶„ì„ì„ í•  ë•Œ ë¹¼ê±°ë‚˜ ë„£ì„ ìˆ˜ ìˆê² ìŠµë‹ˆë‹¤.


```python
sns.countplot(x= 'Topic', data = df,hue = 'Class', hue_order=['L','M','H'])

plt.xticks(rotation=90)

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_49_0.png)


ITì„ íƒ í•™ìƒì€ Lì´ ë§ë„¤ìš”.

bioê°€ Hì…ë‹ˆë‹¤.

í•™ìƒë“¤ì´ ì–´ë–¤ ê³¼ëª©ì„ ì–´ë ¤ì›Œí•˜ëŠ”ì§€ë¥¼ ì•Œ ìˆ˜ ìˆê² ì£ .

### ë²”ì£¼í˜• ì»¬ëŸ¼ -> ìˆ˜ì¹˜ë¡œ ë³€ê²½

 


```python
# L, M, Hë¥¼ ìˆ«ìë¡œ ë°”ê¾¸ì–´ í‘œí˜„
# DFì˜ map() ë©”ì†Œë“œ ì‚¬ìš©

df['Class_value'] = df['Class'].map(dict(L=-1,M=0,H=1)) # class_valueë¼ëŠ” íŒŒìƒë³€ìˆ˜ ìƒì„±
print(df.head().to_markdown)
```

    <bound method DataFrame.to_markdown of   gender NationalITy PlaceofBirth  ... StudentAbsenceDays Class Class_value
    0      M          KW       KuwaIT  ...            Under-7     M           0
    1      M          KW       KuwaIT  ...            Under-7     M           0
    2      M          KW       KuwaIT  ...            Above-7     L          -1
    3      M          KW       KuwaIT  ...            Above-7     L          -1
    4      M          KW       KuwaIT  ...            Above-7     M           0
    
    [5 rows x 18 columns]>


Class_value ì»¬ëŸ¼ìœ¼ë¡œ ì‹œê°í™”


```python
gb_gender =  df.groupby('gender').mean()['Class_value']
gb_gender

plt.bar(gb_gender.index,gb_gender)
plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_54_0.png)


ë‚¨í•™ìƒì€ Lì´ ë§ì•„ ìŒìˆ˜ë¡œ ë‚˜íƒ€ë‚¨


```python
gb =  df.groupby('Topic').mean()['Class_value'].sort_values()

gb



plt.barh(gb.index,gb)

plt.show()
```


![png](%ED%95%99%EC%8A%B5_files/%ED%95%99%EC%8A%B5_56_0.png)


IT/SpanishëŠ” ì„±ì ì´ ë‚®ê³ 

Bioê°€ ì„±ì ì´ ë†’ìŒ


```python
gb =  df.groupby('StudentAbsenceDays').mean()['Class_value'].sort_values()

gb



plt.barh(gb.index,gb)

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_58_0.png)


ê²°ì„ì´ 7ì´í•˜ë©´ 0.4ë¡œ ì„±ì ì´ ì¢‹ì€ í¸

ë‚¨ë…€ ì°¨ì´ë³´ë‹¤ í¬ë‹¤ëŠ” ê±¸ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

# 3. ë°ì´í„° ì „ì²˜ë¦¬



```python
df.columns
```




    Index(['gender', 'NationalITy', 'PlaceofBirth', 'StageID', 'GradeID',
           'SectionID', 'Topic', 'Semester', 'Relation', 'raisedhands',
           'VisITedResources', 'AnnouncementsView', 'Discussion',
           'ParentAnsweringSurvey', 'ParentschoolSatisfaction',
           'StudentAbsenceDays', 'Class', 'Class_value'],
          dtype='object')




```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 480 entries, 0 to 479
    Data columns (total 18 columns):
     #   Column                    Non-Null Count  Dtype 
    ---  ------                    --------------  ----- 
     0   gender                    480 non-null    object
     1   NationalITy               480 non-null    object
     2   PlaceofBirth              480 non-null    object
     3   StageID                   480 non-null    object
     4   GradeID                   480 non-null    object
     5   SectionID                 480 non-null    object
     6   Topic                     480 non-null    object
     7   Semester                  480 non-null    object
     8   Relation                  480 non-null    object
     9   raisedhands               480 non-null    int64 
     10  VisITedResources          480 non-null    int64 
     11  AnnouncementsView         480 non-null    int64 
     12  Discussion                480 non-null    int64 
     13  ParentAnsweringSurvey     480 non-null    object
     14  ParentschoolSatisfaction  480 non-null    object
     15  StudentAbsenceDays        480 non-null    object
     16  Class                     480 non-null    object
     17  Class_value               480 non-null    int64 
    dtypes: int64(5), object(13)
    memory usage: 67.6+ KB


#### get_dummies() ì‚¬ìš©
 one-hot ë²¡í„°ë¡œ ë³€í™˜í•  ë•Œ ì‚¬ìš©



```python
# ë²”ì£¼í˜• ë³€ìˆ˜ ë„£ê¸°



X = pd.get_dummies(df.drop(['ParentschoolSatisfaction', 'Class', 'Class_value'], axis=1), #drop ì•ˆí•˜ë©´ ë‚˜ë¨¸ì§€ëŠ” ìˆ˜ì¹˜í˜•ìœ¼ë¡œ ê°€ì§€ê³ ì˜´/ì»¬ëŸ¼ì—ì„œ ë“œë

                   columns=['gender', 'NationalITy', 'PlaceofBirth',

                            'StageID', 'GradeID','SectionID', 'Topic',

                            'Semester', 'Relation', 'ParentAnsweringSurvey',

                            'StudentAbsenceDays'],

                   drop_first=True) #Multicollinearityë¥¼ í”¼í•˜ê¸° ìœ„í•´ drop_first=Trueë¡œ ì„¤ì •

                     #'ParentschoolSatisfaction', ë°ì´í„° ìŠ¤í€´ì¦ˆ ê°€ëŠ¥ì„±

y = df['Class']

X
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>raisedhands</th>
      <th>VisITedResources</th>
      <th>AnnouncementsView</th>
      <th>Discussion</th>
      <th>gender_M</th>
      <th>NationalITy_Iran</th>
      <th>NationalITy_Iraq</th>
      <th>NationalITy_Jordan</th>
      <th>NationalITy_KW</th>
      <th>NationalITy_Lybia</th>
      <th>NationalITy_Morocco</th>
      <th>NationalITy_Palestine</th>
      <th>NationalITy_SaudiArabia</th>
      <th>NationalITy_Syria</th>
      <th>NationalITy_Tunis</th>
      <th>NationalITy_USA</th>
      <th>NationalITy_lebanon</th>
      <th>NationalITy_venzuela</th>
      <th>PlaceofBirth_Iran</th>
      <th>PlaceofBirth_Iraq</th>
      <th>PlaceofBirth_Jordan</th>
      <th>PlaceofBirth_KuwaIT</th>
      <th>PlaceofBirth_Lybia</th>
      <th>PlaceofBirth_Morocco</th>
      <th>PlaceofBirth_Palestine</th>
      <th>PlaceofBirth_SaudiArabia</th>
      <th>PlaceofBirth_Syria</th>
      <th>PlaceofBirth_Tunis</th>
      <th>PlaceofBirth_USA</th>
      <th>PlaceofBirth_lebanon</th>
      <th>PlaceofBirth_venzuela</th>
      <th>StageID_MiddleSchool</th>
      <th>StageID_lowerlevel</th>
      <th>GradeID_G-04</th>
      <th>GradeID_G-05</th>
      <th>GradeID_G-06</th>
      <th>GradeID_G-07</th>
      <th>GradeID_G-08</th>
      <th>GradeID_G-09</th>
      <th>GradeID_G-10</th>
      <th>GradeID_G-11</th>
      <th>GradeID_G-12</th>
      <th>SectionID_B</th>
      <th>SectionID_C</th>
      <th>Topic_Biology</th>
      <th>Topic_Chemistry</th>
      <th>Topic_English</th>
      <th>Topic_French</th>
      <th>Topic_Geology</th>
      <th>Topic_History</th>
      <th>Topic_IT</th>
      <th>Topic_Math</th>
      <th>Topic_Quran</th>
      <th>Topic_Science</th>
      <th>Topic_Spanish</th>
      <th>Semester_S</th>
      <th>Relation_Mum</th>
      <th>ParentAnsweringSurvey_Yes</th>
      <th>StudentAbsenceDays_Under-7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15</td>
      <td>16</td>
      <td>2</td>
      <td>20</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>20</td>
      <td>3</td>
      <td>25</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>7</td>
      <td>0</td>
      <td>30</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30</td>
      <td>25</td>
      <td>5</td>
      <td>35</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>40</td>
      <td>50</td>
      <td>12</td>
      <td>50</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>475</th>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>476</th>
      <td>50</td>
      <td>77</td>
      <td>14</td>
      <td>28</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>477</th>
      <td>55</td>
      <td>74</td>
      <td>25</td>
      <td>29</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>478</th>
      <td>30</td>
      <td>17</td>
      <td>14</td>
      <td>57</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>479</th>
      <td>35</td>
      <td>14</td>
      <td>23</td>
      <td>62</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>480 rows Ã— 59 columns</p>
</div>



## í•™ìŠµë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ë°ì´í„° ë¶„ë¦¬


# 4. ëª¨ë¸ë§


```python
from sklearn.model_selection import train_test_split
```


```python
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=5)
```

##  Classification ëª¨ë¸ í•™ìŠµ


###  Logistic Regression ëª¨ë¸ ìƒì„±/í•™ìŠµí•˜ê¸°


```python
from sklearn.linear_model import LogisticRegression
```


```python
# LogisticRegression ëª¨ë¸ ìƒì„±/í•™ìŠµ

model_lr = LogisticRegression(max_iter = 10000) #max_iterationì— ëŒ€í•´ ëŠ˜ë ¤ë¼ê³  ë‚˜ì˜´ Increase the number of iterations (max_iter)

model_lr.fit(X_train, y_train)
```




    LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
                       intercept_scaling=1, l1_ratio=None, max_iter=10000,
                       multi_class='auto', n_jobs=None, penalty='l2',
                       random_state=None, solver='lbfgs', tol=0.0001, verbose=0,
                       warm_start=False)



### regression ëª¨ë¸ í•™ìŠµ ê²°ê³¼ í‰ê°€
- classification_report() ê²°ê³¼ ì¶œë ¥í•˜ê¸°



```python
from sklearn.metrics import classification_report
```


```python
# Predictë¥¼ ìˆ˜í–‰í•˜ê³  classification_report() ê²°ê³¼ ì¶œë ¥í•˜ê¸°

pred = model_lr.predict(X_test)

print(classification_report(y_test,pred))
```

                  precision    recall  f1-score   support
    
               H       0.74      0.74      0.74        50
               L       0.85      0.70      0.77        33
               M       0.66      0.72      0.69        61
    
        accuracy                           0.72       144
       macro avg       0.75      0.72      0.73       144
    weighted avg       0.73      0.72      0.72       144


â€‹    

### XGBoost ëª¨ë¸ ìƒì„±/í•™ìŠµ


```python
from xgboost import XGBClassifier
```


```python
model_xgb = XGBClassifier()

model_xgb.fit(X_train, y_train)
```




    XGBClassifier(base_score=0.5, booster='gbtree', colsample_bylevel=1,
                  colsample_bynode=1, colsample_bytree=1, gamma=0,
                  learning_rate=0.1, max_delta_step=0, max_depth=3,
                  min_child_weight=1, missing=None, n_estimators=100, n_jobs=1,
                  nthread=None, objective='multi:softprob', random_state=0,
                  reg_alpha=0, reg_lambda=1, scale_pos_weight=1, seed=None,
                  silent=None, subsample=1, verbosity=1)



### XGBoost ëª¨ë¸ í•™ìŠµ ê²°ê³¼ í‰ê°€
- Predict ìˆ˜í–‰ í›„ classification_report() ê²°ê³¼ ì¶œë ¥í•˜ê¸°


```python
pred = model_xgb.predict(X_test)

print(classification_report(y_test,pred))
```

                  precision    recall  f1-score   support
    
               H       0.68      0.64      0.66        50
               L       0.79      0.67      0.72        33
               M       0.58      0.66      0.62        61
    
        accuracy                           0.65       144
       macro avg       0.68      0.65      0.67       144
    weighted avg       0.66      0.65      0.66       144


â€‹    

## ëª¨ë¸ í•™ìŠµ ê²°ê³¼ ì‹¬ì¸µ ë¶„ì„


### ìƒê´€ì„± íŒŒì•… - Logistic Regression ëª¨ë¸ ê³„ìˆ˜



Logistic Regression ëª¨ë¸ì˜ coef_ ì†ì„±ì„ plotí•˜ê¸°




```python
 model_lr.coef_.shape 
```




    (3, 59)



3ì€ í´ë˜ìŠ¤ì´ë©°, 59ëŠ” í”¼ì³ì˜ ê°¯ìˆ˜ì…ë‹ˆë‹¤.


```python
model_lr.classes_
```




    array(['H', 'L', 'M'], dtype=object)




```python
fig = plt.figure(figsize=(20,10))

plt.bar(X.columns, model_lr.coef_[0, :])  #Hë§Œ ì¶œë ¥

plt.xticks(rotation=90)

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_86_0.png)


Regressionìœ¼ë¡œ ë´¤ì„ ë•Œ ì„±ì ì´ Hì¸ ê²½ìš°, ì˜í–¥ì„ ë§ì´ ì¤€ ê²ƒì€ ê²°ì„ì¼ìˆ˜ë„¤ìš”.

### XGBoost ëª¨ë¸ ë³€ìˆ˜ ì¤‘ìš”ë„

- feature_importances


```python
fig = plt.figure(figsize=(15, 8))

plt.bar(X.columns, model_xgb.feature_importances_)

plt.xticks(rotation=90)

plt.show()
```


![png](í•™ìŠµìš”ì†Œ_files/í•™ìŠµìš”ì†Œ_89_0.png)


ì„±ì  ê²°ì •ì˜ ì¤‘ìš” ìš”ì†ŒëŠ” ê²°ì„ì¼ìˆ˜ì™€ ì–´ë¨¸ë‹ˆê°€ ì±…ì„ìì¼ ê²½ìš°ë¼ê³  í•˜ë„¤ìš”.
